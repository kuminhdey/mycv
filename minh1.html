<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Play M3U8 vá»›i Bearer Token</title>
  <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f4;
      padding: 2rem;
      max-width: 700px;
      margin: auto;
    }

    input, textarea, button {
      width: 100%;
      margin-bottom: 1rem;
      padding: 0.6rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    button {
      background-color: #007bff;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    #video-container {
      margin-top: 2rem;
      display: none;
    }
  </style>
</head>
<body>

  <h2>ðŸ”‘ PhÃ¡t video M3U8 cÃ³ Bearer Token</h2>

  <input type="text" id="m3u8-url" placeholder="Nháº­p Ä‘Æ°á»ng dáº«n M3U8 (https://...)">
  <textarea id="bearer-token" placeholder="Nháº­p Bearer Token táº¡i Ä‘Ã¢y..."></textarea>
  <button onclick="loadVideo()">PhÃ¡t Video</button>

  <div id="video-container">
    <video id="video-player" class="video-js vjs-default-skin" controls preload="auto" width="640" height="360"></video>
  </div>

  <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>

  <script>
    let player;

    function loadVideo() {
      const url = document.getElementById('m3u8-url').value.trim();
      const token = document.getElementById('bearer-token').value.trim();

      if (!url || !token) {
        alert("âš ï¸ Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ M3U8 URL vÃ  Bearer Token.");
        return;
      }

      if (player) {
        player.dispose();
      }

      document.getElementById('video-container').style.display = 'block';

      // Ghi Ä‘Ã¨ XMLHttpRequest Ä‘á»ƒ thÃªm Authorization Header
      const OriginalXHR = window.XMLHttpRequest;
      function CustomXHR() {
        const xhr = new OriginalXHR();
        const originalOpen = xhr.open;
        xhr.open = function () {
          originalOpen.apply(xhr, arguments);
          xhr.setRequestHeader('Authorization', `Bearer ${token}`);
        };
        return xhr;
      }
      window.XMLHttpRequest = CustomXHR;

      player = videojs('video-player', {
        controls: true,
        autoplay: false,
        preload: 'auto',
        sources: [{
          src: url,
          type: 'application/x-mpegURL',
        }],
        html5: {
          vhs: {
            withCredentials: false
          }
        }
      });

      player.ready(() => {
        player.play();
      });
    }
  </script>
</body>
</html>
