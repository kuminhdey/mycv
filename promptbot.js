'use strict';const _0x361f68=_0x36a4;(function(_0x3879bd,_0xed44a8){const _0x570cc0=_0x36a4,_0xbddfdf=_0x3879bd();while(!![]){try{const _0x145a75=parseInt(_0x570cc0(0x15a))/0x1+parseInt(_0x570cc0(0x144))/0x2+-parseInt(_0x570cc0(0x18b))/0x3*(-parseInt(_0x570cc0(0x173))/0x4)+-parseInt(_0x570cc0(0x192))/0x5*(parseInt(_0x570cc0(0x165))/0x6)+-parseInt(_0x570cc0(0x14b))/0x7+-parseInt(_0x570cc0(0x190))/0x8*(parseInt(_0x570cc0(0x168))/0x9)+-parseInt(_0x570cc0(0x19d))/0xa*(parseInt(_0x570cc0(0x148))/0xb);if(_0x145a75===_0xed44a8)break;else _0xbddfdf['push'](_0xbddfdf['shift']());}catch(_0xd0cdc1){_0xbddfdf['push'](_0xbddfdf['shift']());}}}(_0x2c42,0x9aae8));const CONFIG={'MODEL':'gemini-1.5-flash','TIMEOUT_MS':0xea60,'MAX_RETRIES':0x4,'BACKOFF_BASE_MS':0x5dc,'BACKOFF_CAP_MS':0x3a98};let STATE={'apiKey':'','selectors':{'getRoot':()=>{const _0xdaaa7f=_0x36a4,_0x54e82a=document[_0xdaaa7f(0x194)](_0xdaaa7f(0x180));return _0x54e82a?.[_0xdaaa7f(0x181)]||_0x54e82a?.[_0xdaaa7f(0x17f)]?.[_0xdaaa7f(0x17c)]||document;},'question':_0x361f68(0x15c),'joditContainer':_0x361f68(0x15e),'joditEditable':_0x361f68(0x14e)}};const sleep=_0x4a0a7f=>new Promise(_0x5996a4=>setTimeout(_0x5996a4,_0x4a0a7f)),esc=_0x33d508=>String(_0x33d508)[_0x361f68(0x19a)](/[&<>]/g,_0x316ef1=>({'&':_0x361f68(0x158),'<':'&lt;','>':_0x361f68(0x162)}[_0x316ef1]));async function promptApiKeyNative(){const _0x16454e=_0x361f68,_0x126741=_0x16454e(0x161),_0x2136d2=prompt(_0x126741,''),_0xa9b0b8=(_0x2136d2||'')[_0x16454e(0x171)]();return _0xa9b0b8||null;}export function setApiKey(_0x1fe0b7){const _0x2c83dd=_0x361f68;STATE[_0x2c83dd(0x183)]=String(_0x1fe0b7||'')['trim']();}export function setSelectors(_0x112600){const _0x169ee2=_0x361f68;Object[_0x169ee2(0x18f)](STATE[_0x169ee2(0x184)],_0x112600||{});}export function getState(){return STATE;}export function getConfig(){return CONFIG;}async function callGemini({system:_0x6abdd,user:_0x17c2ba,model:model=CONFIG[_0x361f68(0x149)],maxRetries:maxRetries=CONFIG[_0x361f68(0x153)],temperature:temperature=0.2}){const _0x3598a2=_0x361f68;if(!STATE[_0x3598a2(0x183)])throw new Error('Chưa\x20có\x20API\x20key');const _0x4b1a95=_0x3598a2(0x15b)+encodeURIComponent(model)+':generateContent?key='+encodeURIComponent(STATE['apiKey']);let _0x536ca6=0x0,_0x5376ac;while(_0x536ca6<=maxRetries){try{const _0x33f04a=new AbortController(),_0x1b04e9=setTimeout(()=>_0x33f04a[_0x3598a2(0x16e)](),CONFIG[_0x3598a2(0x172)]),_0x550b09={..._0x6abdd?{'systemInstruction':{'role':_0x3598a2(0x176),'parts':[{'text':_0x6abdd}]}}:{},'contents':[{'role':'user','parts':[{'text':_0x17c2ba}]}],'generationConfig':{'temperature':temperature}},_0x4df603=await fetch(_0x4b1a95,{'method':_0x3598a2(0x16a),'headers':{'Content-Type':'application/json'},'body':JSON[_0x3598a2(0x186)](_0x550b09),'signal':_0x33f04a[_0x3598a2(0x140)]});clearTimeout(_0x1b04e9);if(!_0x4df603['ok']){if(_0x4df603[_0x3598a2(0x197)]===0x1ad||_0x4df603[_0x3598a2(0x197)]>=0x1f4&&_0x4df603[_0x3598a2(0x197)]<0x258){const _0x4fdff0=_0x4df603[_0x3598a2(0x174)][_0x3598a2(0x198)](_0x3598a2(0x166));let _0x3aaafd=_0x4fdff0?Number(_0x4fdff0)*0x3e8:null;if(!_0x3aaafd||Number[_0x3598a2(0x182)](_0x3aaafd)){const _0x1bbf07=Math['floor'](Math['random']()*0x190);_0x3aaafd=Math[_0x3598a2(0x178)](CONFIG['BACKOFF_BASE_MS']*(_0x536ca6+0x1)**0x2+_0x1bbf07,CONFIG[_0x3598a2(0x142)]);}console[_0x3598a2(0x16f)](_0x3598a2(0x179)+_0x4df603[_0x3598a2(0x197)]+_0x3598a2(0x150)+(_0x536ca6+0x1)+_0x3598a2(0x1a2)+_0x3aaafd+'ms'),await sleep(_0x3aaafd),_0x536ca6++;continue;}const _0x7c71a9=await _0x4df603[_0x3598a2(0x195)]()['catch'](()=>'');throw new Error(_0x3598a2(0x14d)+_0x4df603[_0x3598a2(0x197)]+':\x20'+_0x7c71a9);}const _0xccb3aa=await _0x4df603[_0x3598a2(0x19f)](),_0x3a8cdb=_0xccb3aa?.[_0x3598a2(0x152)]?.[0x0]?.['content']?.['parts']?.[_0x3598a2(0x163)](_0x2b1214=>_0x2b1214[_0x3598a2(0x195)])[_0x3598a2(0x13f)]('')?.[_0x3598a2(0x171)]()||_0xccb3aa?.[_0x3598a2(0x152)]?.[0x0]?.[_0x3598a2(0x16d)]?.[_0x3598a2(0x191)]?.[0x0]?.[_0x3598a2(0x195)]?.[_0x3598a2(0x171)]()||'';if(!_0x3a8cdb)throw new Error(_0x3598a2(0x19b));return _0x3a8cdb;}catch(_0x505a05){_0x5376ac=_0x505a05;const _0x39d355=Math[_0x3598a2(0x19e)](Math['random']()*0x190),_0x50456e=Math[_0x3598a2(0x178)](CONFIG['BACKOFF_BASE_MS']*(_0x536ca6+0x1)**0x2+_0x39d355,CONFIG['BACKOFF_CAP_MS']);console['warn'](_0x3598a2(0x177)+(_0x536ca6+0x1)+'/'+(maxRetries+0x1)+'):\x20'+(_0x505a05?.[_0x3598a2(0x159)]||_0x505a05)+_0x3598a2(0x167)+_0x50456e+'ms'),await sleep(_0x50456e),_0x536ca6++;}}throw _0x5376ac||new Error('Gemini\x20call\x20failed');}function _0x2c42(){const _0x4744d5=['parentElement','trim','TIMEOUT_MS','3112bXbAEy','headers','remove','system','Gemini\x20request\x20failed\x20(attempt\x20','min','Gemini\x20','appendChild','log','document','clipboard','Không\x20chèn\x20được\x20vào\x20Jodit.\x20Hiển\x20thị\x20overlay\x20thay\x20thế.\x20Lý\x20do:','contentWindow','iframe[data-name=\x22iframe-lesson-player\x22]','contentDocument','isNaN','apiKey','selectors','\x0a\x20\x20\x20\x20position:\x20fixed;\x20inset:\x200;\x20z-index:\x202147483646;\x0a\x20\x20\x20\x20background:\x20rgba(2,6,23,.6);\x20display:flex;\x20align-items:center;\x20justify-content:center;\x0a\x20\x20','stringify','joditContainer','\x0aTask:\x20Based\x20on\x20this\x20instruction,\x20write\x20a\x20single\x20high-quality\x20PROMPT\x20that\x20I\x20can\x20give\x20to\x20an\x20AI\x20so\x20it\x20will\x20generate\x20API\x20test\x20cases\x20(with\x20request\x20payloads,\x20expected\x20responses,\x20and\x20error\x20handling)\x20for\x20a\x20\x22user\x20management\x22\x20API.\x0aThe\x20prompt\x20should\x20instruct\x20the\x20AI\x20to:\x0a-\x20enumerate\x20endpoints\x20found\x20in\x20the\x20spec,\x0a-\x20cover\x20valid/invalid\x20payloads\x20and\x20boundary\x20cases,\x0a-\x20include\x20authentication/authorization\x20scenarios\x20if\x20applicable,\x0a-\x20specify\x20expected\x20HTTP\x20status\x20codes\x20and\x20JSON\x20schemas,\x0a-\x20include\x20negative\x20tests\x20(missing\x20fields,\x20wrong\x20types,\x20constraint\x20violations),\x0a-\x20and\x20format\x20the\x20output\x20clearly\x20(tables\x20or\x20JSON).\x0a\x0aOriginal\x20question:\x0a\x22','\x0a\x20\x20\x20\x20width:\x20min(900px,\x2092vw);\x20max-height:\x2080vh;\x20overflow:\x20auto;\x0a\x20\x20\x20\x20background:\x20#fff;\x20color:#0f172a;\x20border-radius:\x2014px;\x20padding:\x2016px;\x20box-shadow:\x200\x2010px\x2040px\x20rgba(0,0,0,.25);\x0a\x20\x20\x20\x20font-family:\x20ui-sans-serif,\x20system-ui,\x20-apple-system,\x20Segoe\x20UI,\x20Roboto,\x20Helvetica,\x20Arial,\x20\x27Apple\x20Color\x20Emoji\x27,\x27Segoe\x20UI\x20Emoji\x27;\x0a\x20\x20','error','3804HjnlBD','</pre>\x0a\x20\x20','[OK]\x20Đã\x20điền\x20nội\x20dung\x20vào\x20Jodit.','Không\x20có\x20API\x20key\x20→\x20dừng.','assign','465512RHilEX','parts','1143375sdYejw','</pre>\x0a\x20\x20\x20\x20','querySelector','text','question','status','get','body','replace','No\x20content\x20from\x20Gemini','addEventListener','60pQjevH','floor','json','dispatchEvent','input','\x20in\x20','join','signal','#pb-close','BACKOFF_CAP_MS','click','393760ZCZTSD','Nội\x20dung\x20mới','createElement','onclick','51953VtUuBG','MODEL','#pb-copy','1743147kZWkIf','\x0a\x20\x20\x20\x20<div\x20style=\x22display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:10px\x22>\x0a\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin:0;font-size:16px;font-weight:700\x22>Proposed\x20Prompt</h3>\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:flex;gap:8px\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22pb-copy\x22\x20style=\x22padding:8px\x2010px;border:1px\x20solid\x20#cbd5e1;background:#f8fafc;border-radius:10px;cursor:pointer\x22>Copy</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22pb-close\x22\x20style=\x22padding:8px\x2010px;border:0;background:#2563eb;color:#fff;border-radius:10px;cursor:pointer\x22>Close</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<pre\x20style=\x22white-space:pre-wrap;font-family:\x20ui-monospace,\x20SFMono-Regular,\x20Menlo,\x20monospace;\x20margin:0\x22>','Gemini\x20HTTP\x20','.jodit-wysiwyg[contenteditable=\x22true\x22]','cssText','.\x20Retry\x20#','div','candidates','MAX_RETRIES','You\x20are\x20a\x20senior\x20QA\x20engineer\x20and\x20prompt\x20engineer.\x20Return\x20only\x20the\x20final\x20prompt\x20text\x20(no\x20extra\x20commentary).\x20The\x20prompt\x20must\x20be\x20clear,\x20structured,\x20and\x20directly\x20usable.','joditEditable','undefined','textContent','&amp;','message','945439hMcxsT','https://generativelanguage.googleapis.com/v1beta/models/','p.para-big.disable-select,\x20p.para-big,\x20.para-big.disable-select','Copied!','.jodit-container','getRoot','PromptBot','Nhập\x20Gemini\x20API\x20key\x20(tạo\x20tại\x20https://aistudio.google.com/app/apikey):','&gt;','map','\x0a\x20\x20\x20\x20\x20\x20<h3>Proposed\x20Prompt\x20for\x20Generating\x20API\x20Test\x20Cases</h3>\x0a\x20\x20\x20\x20\x20\x20<pre\x20style=\x22white-space:\x20pre-wrap;\x20font-family:\x20ui-monospace,\x20SFMono-Regular,\x20Menlo,\x20monospace;\x22>','6uNUaIL','retry-after','.\x20Retry\x20in\x20','153pqJxYP','writeText','POST','style','change','content','abort','warn'];_0x2c42=function(){return _0x4744d5;};return _0x2c42();}function getRoot(){const _0x1455cb=_0x361f68;return STATE[_0x1455cb(0x184)][_0x1455cb(0x15f)]();}function getQuestion(_0x136ae3=document){const _0x2fa29b=_0x361f68,_0x56d094=_0x136ae3[_0x2fa29b(0x194)](STATE[_0x2fa29b(0x184)][_0x2fa29b(0x196)]),_0x55ca93=_0x56d094?.['innerText']?.[_0x2fa29b(0x171)]();return _0x55ca93||null;}function setJoditContent(_0x7185c0=document,_0x57a923=_0x361f68(0x145)){const _0x1ccfc8=_0x361f68,_0xb7804d=_0x7185c0[_0x1ccfc8(0x194)](STATE[_0x1ccfc8(0x184)][_0x1ccfc8(0x187)]),_0x4acb0d=_0xb7804d?.[_0x1ccfc8(0x194)](STATE[_0x1ccfc8(0x184)][_0x1ccfc8(0x155)]);if(!_0x4acb0d)throw new Error('Không\x20tìm\x20thấy\x20vùng\x20soạn\x20thảo\x20.jodit-wysiwyg');_0x4acb0d['innerHTML']=_0x57a923,_0x4acb0d[_0x1ccfc8(0x1a0)](new InputEvent(_0x1ccfc8(0x1a1),{'bubbles':!![]})),_0x4acb0d[_0x1ccfc8(0x1a0)](new Event(_0x1ccfc8(0x16c),{'bubbles':!![]}));const _0x5a1018=_0xb7804d[_0x1ccfc8(0x170)]?.[_0x1ccfc8(0x194)]('textarea#jodit-editor');_0x5a1018&&(_0x5a1018[_0x1ccfc8(0x1a0)](new InputEvent(_0x1ccfc8(0x1a1),{'bubbles':!![]})),_0x5a1018['dispatchEvent'](new Event(_0x1ccfc8(0x16c),{'bubbles':!![]})));}function showResultOverlay(_0x1fee37){const _0xcd0a2d=_0x361f68,_0x50c3bd=document['createElement'](_0xcd0a2d(0x151));_0x50c3bd[_0xcd0a2d(0x16b)]['cssText']=_0xcd0a2d(0x185);const _0x5089e8=document[_0xcd0a2d(0x146)]('div');_0x5089e8['style'][_0xcd0a2d(0x14f)]=_0xcd0a2d(0x189),_0x5089e8['innerHTML']=_0xcd0a2d(0x14c)+esc(_0x1fee37)+_0xcd0a2d(0x18c),_0x50c3bd[_0xcd0a2d(0x17a)](_0x5089e8),document[_0xcd0a2d(0x199)][_0xcd0a2d(0x17a)](_0x50c3bd),_0x5089e8[_0xcd0a2d(0x194)](_0xcd0a2d(0x141))[_0xcd0a2d(0x147)]=()=>_0x50c3bd[_0xcd0a2d(0x175)](),_0x5089e8[_0xcd0a2d(0x194)](_0xcd0a2d(0x14a))[_0xcd0a2d(0x147)]=async()=>{const _0x202675=_0xcd0a2d;try{await navigator[_0x202675(0x17d)][_0x202675(0x169)](_0x1fee37),_0x5089e8[_0x202675(0x194)](_0x202675(0x14a))['textContent']=_0x202675(0x15d);}catch{_0x5089e8['querySelector']('#pb-copy')[_0x202675(0x157)]='Copy\x20failed';}setTimeout(()=>{const _0x3e67ad=_0x202675;_0x5089e8[_0x3e67ad(0x194)](_0x3e67ad(0x14a))[_0x3e67ad(0x157)]='Copy';},0x4b0);},_0x50c3bd[_0xcd0a2d(0x19c)](_0xcd0a2d(0x143),_0x351153=>{const _0x5814e6=_0xcd0a2d;if(_0x351153['target']===_0x50c3bd)_0x50c3bd[_0x5814e6(0x175)]();});}function _0x36a4(_0x4eaa2a,_0x10b209){const _0x2c423a=_0x2c42();return _0x36a4=function(_0x36a4de,_0x4469bd){_0x36a4de=_0x36a4de-0x13f;let _0x58c505=_0x2c423a[_0x36a4de];return _0x58c505;},_0x36a4(_0x4eaa2a,_0x10b209);}export async function runPromptFill(_0x162bd4={}){const _0x50755f=_0x361f68,{apiKey:_0x2a1cd7,questionOverride:_0x267a33,insertToJodit:insertToJodit=!![]}=_0x162bd4;if(_0x2a1cd7)setApiKey(_0x2a1cd7);if(!STATE[_0x50755f(0x183)]){const _0x587d31=await promptApiKeyNative();if(!_0x587d31)throw new Error(_0x50755f(0x18e));setApiKey(_0x587d31);}try{const _0xa934e0=getRoot(),_0x355fd5=_0x267a33||getQuestion(_0xa934e0)||'You\x20have\x20an\x20API\x20documentation\x20describing\x20endpoints\x20for\x20user\x20management.\x20Draft\x20a\x20prompt\x20that\x20instructs\x20the\x20AI\x20to\x20generate\x20sample\x20API\x20test\x20cases,\x20including\x20input\x20payloads,\x20expected\x20responses,\x20and\x20error\x20handling\x20conditions.',_0x45b8b2=_0x50755f(0x154),_0x3ab701=(_0x50755f(0x188)+_0x355fd5+'\x22\x0a\x0aConstraints:\x0a-\x20Output\x20ONLY\x20the\x20final\x20prompt\x20(no\x20explanations).\x0a-\x20Make\x20it\x20generic\x20but\x20with\x20placeholders\x20(e.g.,\x20{{baseUrl}},\x20{{authHeader}},\x20{{endpoints}})\x20so\x20I\x20can\x20reuse\x20it\x20with\x20any\x20user\x20management\x20spec.\x0a-\x20Keep\x20it\x20concise\x20but\x20comprehensive.\x0a')[_0x50755f(0x171)](),_0x57a8a5=await callGemini({'system':_0x45b8b2,'user':_0x3ab701,'temperature':0.2}),_0x4a694f=_0x50755f(0x164)+esc(_0x57a8a5)+_0x50755f(0x193);if(insertToJodit)try{setJoditContent(_0xa934e0,_0x4a694f),console[_0x50755f(0x17b)](_0x50755f(0x18d));}catch(_0x3701c7){console['warn'](_0x50755f(0x17e),_0x3701c7?.['message']||_0x3701c7),showResultOverlay(_0x57a8a5);}else showResultOverlay(_0x57a8a5);return _0x57a8a5;}catch(_0x33b185){console[_0x50755f(0x18a)]('Lỗi:',_0x33b185);throw _0x33b185;}}typeof window!==_0x361f68(0x156)&&(window[_0x361f68(0x160)]={'runPromptFill':runPromptFill,'setApiKey':setApiKey,'setSelectors':setSelectors,'getState':getState,'getConfig':getConfig,'_STATE':STATE,'_CONFIG':CONFIG});
